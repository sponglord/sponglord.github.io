<!-- RE. https://internetingishard.com/html-and-css/flexbox/ -->
<!DOCTYPE html>
<html lang='en'>
<head>
    <meta charset='UTF-8'/>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=yes">
    <title>Which Way?</title>
    <link rel='stylesheet' href='styles_orig.css'/>
</head>
<body>
    <div class='direction-grid-container'>
        <div class='direction-grid'>
            <div id="d1" class='direction-grid-item end-item left'>
                <img src='images/1_dir.jpg'/>
            </div>
            <div id="d2" class='direction-grid-item next-to-end-item left'>
                <img src='images/2_dir.jpg'/>
            </div>
            <div id="d3" class='direction-grid-item middle-item left'>
                <img src='images/3_dir.jpg'/>
            </div>
            <div id="d4" class='direction-grid-item middle-item right'>
                <img src='images/4_dir.jpg'/>
            </div>
            <div id="d5" class='direction-grid-item next-to-end-item right'>
                <img src='images/5_dir.jpg'/>
            </div>
            <div id="d6" class='direction-grid-item end-item right'>
                <img src='images/6_dir.jpg'/>
            </div>

        </div>
    </div>
    <div class='instructions-container'>
        <div class='instructions'>
            <p>How many directions are there to choose from?</p>
        </div>
    </div>
    <div class="buttons-container">
        <div class="buttons">
            <div id="b2" class='button-item'>
                <img src='images/2_btn.png'/>
            </div>
            <div id="b3" class='button-item'>
                <img src='images/3_btn.png'/>
            </div>
            <div id="b4" class='button-item'>
                <img src='images/4_btn.png'/>
            </div>
            <div id="b5" class='button-item'>
                <img src='images/5_btn.png'/>
            </div>
            <div id="b6" class='button-item'>
                <img src='images/6_btn.png'/>
            </div>
        </div>
    </div>
    <div class='footer-container'>
        <div class='footer'>
            <div class="desc">
                <div class='login'>Which Way?</div>
                <div class='copyright'>&#0169 2021</div>
            </div>
            <div class='tag'>Careful...you might get lost!</div>
        </div>
    </div>

    <script type="application/javascript">
        // get ref to direction elements
        const dirs = document.querySelectorAll('.direction-grid-item');
        const dirsArr = Array.from(dirs);

        // Add event listeners
        const btns = document.querySelectorAll('.button-item');
        const btnsArr = Array.from(btns);

        const listener = (e)=>{
            const btnId = e.currentTarget.getAttribute('id').substring(1);
            randomise(btnId);
        };

        btnsArr.forEach((btn)=>{
            btn.addEventListener('click', listener);
        });

        // Create random number and style the direction elements accordingly
        const randomise = (btnId) => {
            const ranNum = Math.floor(Math.random() * btnId) + 1;
            console.log('### index_what-way::randomise:: ranNum', ranNum );

            dirsArr.forEach((dir, index) => {
                // Remove pre-existing conditional classes
                dir.classList.remove('deselected','selected','hide-item', 'shown', 'end-item', 'next-to-end-item', 'middle-item', 'left', 'right');

                // Hide items higher than the number of possible directions
                const dirId = dir.getAttribute('id').substring(1);
                if(btnId < dirId){
                    dir.classList.add('hide-item');
                }

                // Mark one as selected, the other, visible ones, as not
                if(index === ranNum - 1){
                    dir.classList.add('selected','shown');
                }else if(btnId >= dirId){
                    dir.classList.add('deselected','shown');
                }
            });


            // How many items are left visible
            const dirsVisible = document.querySelectorAll('.direction-grid-item.shown');
            const dirsVisibleArr = Array.from(dirsVisible);

            // Assign rotation classes etc
            assignLayout(dirsVisibleArr);
        }

        const assignLayout = (dirsArr) => {

            const len = dirsArr.length;

            // end items
            if(len !== 2){
//                if(len > 3){ // gives alt, less interesting layout for 3 items
                dirsArr[0].classList.add('end-item', 'left');
                dirsArr[len - 1].classList.add('end-item', 'right');
            }else{
                dirsArr[0].classList.add('next-to-end-item', 'left');
                dirsArr[len - 1].classList.add('next-to-end-item', 'right');
            }

            // next-to-end-items
            if(len > 3){
                dirsArr[1].classList.add('next-to-end-item', 'left');
                dirsArr[len - 2].classList.add('next-to-end-item', 'right');
            }

            // middle items
            if(len === 3 || len === 5){
                const midIndex = Math.floor(len/2);
                dirsArr[midIndex].classList.add('middle-item');
            }

            if(len === 6){
                dirsArr[2].classList.add('middle-item', 'left');
                dirsArr[len - 3].classList.add('middle-item', 'right');
            }
        };
    </script>

</body>
</html>
